{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{jsx as _jsx}from\"react/jsx-runtime\";import _asyncToGenerator from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{Menu,Input,Icon}from'semantic-ui-react';import{debounce,getYouTubeResults}from'../../utils';import{examples}from'../../utils/examples';import{YouTubeSearchResult}from'../SearchResult/SearchResult';export var ComboBox=/*#__PURE__*/function(_React$Component){_inherits(ComboBox,_React$Component);var _super=_createSuper(ComboBox);function ComboBox(){var _this;_classCallCheck(this,ComboBox);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={inputMedia:undefined,results:undefined,loading:false,lastResultTimestamp:Number(new Date())};_this.debounced=null;_this.setMedia=function(e,data){window.setTimeout(function(){return _this.setState({inputMedia:undefined,results:undefined});},300);_this.props.setMedia(e,data);};_this.doSearch=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.persist();_this.setState({inputMedia:e.target.value},function(){if(!_this.debounced){_this.debounced=debounce(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var query,timestamp,results,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({loading:true});query=_this.state.inputMedia||'';timestamp=Number(new Date());results=undefined;if(!(query===''||query&&query.startsWith('http'))){_context.next=8;break;}results=examples.map(function(option){return/*#__PURE__*/_jsx(Menu.Item,{onClick:function onClick(e){return _this.setMedia(e,{value:option.url});},children:option.url},option.url);});_context.next=12;break;case 8:_context.next=10;return getYouTubeResults(query);case 10:data=_context.sent;results=data.map(function(result){return/*#__PURE__*/_jsx(YouTubeSearchResult,_objectSpread(_objectSpread({},result),{},{setMedia:_this.setMedia}),result.url);});case 12:if(timestamp>_this.state.lastResultTimestamp){_this.setState({loading:false,results:results,lastResultTimestamp:timestamp});}case 13:case\"end\":return _context.stop();}}},_callee);})),500);}_this.debounced();});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref.apply(this,arguments);};}();return _this;}_createClass(ComboBox,[{key:\"render\",value:function render(){var _this2=this;var _this$props=this.props,currentMedia=_this$props.currentMedia,getMediaDisplayName=_this$props.getMediaDisplayName;var results=this.state.results;return/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative'},children:[/*#__PURE__*/_jsx(\"div\",{style:{display:'flex'},children:/*#__PURE__*/_jsx(Input,{style:{flexGrow:1},inverted:true,fluid:true,focus:true,disabled:this.props.disabled,onChange:this.doSearch,onFocus:function onFocus(e){e.persist();_this2.setState({inputMedia:getMediaDisplayName(currentMedia)},function(){if(!_this2.state.inputMedia||_this2.state.inputMedia&&_this2.state.inputMedia.startsWith('http')){_this2.doSearch(e);}});setTimeout(function(){return e.target.select();},100);},onBlur:function onBlur(){return setTimeout(function(){return _this2.setState({inputMedia:undefined,results:undefined});},100);},onKeyPress:function onKeyPress(e){if(e.key==='Enter'){_this2.setMedia(e,{value:_this2.state.inputMedia});}},icon:/*#__PURE__*/_jsx(Icon,{onClick:function onClick(e){return _this2.setMedia(e,{value:_this2.state.inputMedia});},name:\"arrow right\",link:true,circular:true//bordered\n}),loading:this.state.loading,label:'Now Watching:',placeholder:\"Enter video file URL, YouTube link, or YouTube search term\",value:this.state.inputMedia!==undefined?this.state.inputMedia:getMediaDisplayName(currentMedia)})}),Boolean(results)&&this.state.inputMedia!==undefined&&/*#__PURE__*/_jsx(Menu,{fluid:true,vertical:true,style:{position:'absolute',top:'22px',maxHeight:'250px',overflow:'scroll',zIndex:1001},children:results})]});}}]);return ComboBox;}(React.Component);","map":{"version":3,"sources":["/home/runner/work/watchparty/watchparty/src/components/ComboBox/ComboBox.tsx"],"names":["React","Menu","Input","Icon","debounce","getYouTubeResults","examples","YouTubeSearchResult","ComboBox","state","inputMedia","undefined","results","loading","lastResultTimestamp","Number","Date","debounced","setMedia","e","data","window","setTimeout","setState","props","doSearch","persist","target","value","query","timestamp","startsWith","map","option","url","result","currentMedia","getMediaDisplayName","position","display","flexGrow","disabled","select","key","Boolean","top","maxHeight","overflow","zIndex","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { DropdownProps, Menu, Input, Icon } from 'semantic-ui-react';\nimport { debounce, getYouTubeResults } from '../../utils';\nimport { examples } from '../../utils/examples';\nimport { YouTubeSearchResult } from '../SearchResult/SearchResult';\n\ninterface ComboBoxProps {\n  setMedia: Function;\n  currentMedia: string;\n  getMediaDisplayName: Function;\n  launchMultiSelect: Function;\n  mediaPath: string | undefined;\n  streamPath: string | undefined;\n  disabled?: boolean;\n}\n\nexport class ComboBox extends React.Component<ComboBoxProps> {\n  state = {\n    inputMedia: undefined as string | undefined,\n    results: undefined,\n    loading: false,\n    lastResultTimestamp: Number(new Date()),\n  };\n  debounced: any = null;\n\n  setMedia = (e: any, data: DropdownProps) => {\n    window.setTimeout(\n      () => this.setState({ inputMedia: undefined, results: undefined }),\n      300\n    );\n    this.props.setMedia(e, data);\n  };\n\n  doSearch = async (e: any) => {\n    e.persist();\n    this.setState({ inputMedia: e.target.value }, () => {\n      if (!this.debounced) {\n        this.debounced = debounce(async () => {\n          this.setState({ loading: true });\n          const query: string = this.state.inputMedia || '';\n          let timestamp = Number(new Date());\n          let results: JSX.Element[] | undefined = undefined;\n          if (query === '' || (query && query.startsWith('http'))) {\n            results = examples.map((option: any) => (\n              <Menu.Item\n                key={option.url}\n                onClick={(e: any) => this.setMedia(e, { value: option.url })}\n              >\n                {option.url}\n              </Menu.Item>\n            ));\n          } else {\n            const data = await getYouTubeResults(query);\n            results = data.map((result) => (\n              <YouTubeSearchResult\n                key={result.url}\n                {...result}\n                setMedia={this.setMedia}\n              />\n            ));\n          }\n          if (timestamp > this.state.lastResultTimestamp) {\n            this.setState({\n              loading: false,\n              results,\n              lastResultTimestamp: timestamp,\n            });\n          }\n        }, 500);\n      }\n      this.debounced();\n    });\n  };\n\n  render() {\n    const { currentMedia, getMediaDisplayName } = this.props;\n    const { results } = this.state;\n    return (\n      <div style={{ position: 'relative' }}>\n        <div style={{ display: 'flex' }}>\n          <Input\n            style={{ flexGrow: 1 }}\n            inverted\n            fluid\n            focus\n            disabled={this.props.disabled}\n            onChange={this.doSearch}\n            onFocus={(e: any) => {\n              e.persist();\n              this.setState(\n                {\n                  inputMedia: getMediaDisplayName(currentMedia),\n                },\n                () => {\n                  if (\n                    !this.state.inputMedia ||\n                    (this.state.inputMedia &&\n                      this.state.inputMedia.startsWith('http'))\n                  ) {\n                    this.doSearch(e);\n                  }\n                }\n              );\n              setTimeout(() => e.target.select(), 100);\n            }}\n            onBlur={() =>\n              setTimeout(\n                () =>\n                  this.setState({ inputMedia: undefined, results: undefined }),\n                100\n              )\n            }\n            onKeyPress={(e: any) => {\n              if (e.key === 'Enter') {\n                this.setMedia(e, {\n                  value: this.state.inputMedia,\n                });\n              }\n            }}\n            icon={\n              <Icon\n                onClick={(e: any) =>\n                  this.setMedia(e, {\n                    value: this.state.inputMedia,\n                  })\n                }\n                name=\"arrow right\"\n                link\n                circular\n                //bordered\n              />\n            }\n            loading={this.state.loading}\n            label={'Now Watching:'}\n            placeholder=\"Enter video file URL, YouTube link, or YouTube search term\"\n            value={\n              this.state.inputMedia !== undefined\n                ? this.state.inputMedia\n                : getMediaDisplayName(currentMedia)\n            }\n          />\n        </div>\n        {Boolean(results) && this.state.inputMedia !== undefined && (\n          <Menu\n            fluid\n            vertical\n            style={{\n              position: 'absolute',\n              top: '22px',\n              maxHeight: '250px',\n              overflow: 'scroll',\n              zIndex: 1001,\n            }}\n          >\n            {results}\n          </Menu>\n        )}\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}