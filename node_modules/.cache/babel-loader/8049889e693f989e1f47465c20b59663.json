{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/runner/work/watchparty/watchparty/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{serverPath,colorMappings}from'../../utils';import{Icon,Popup,Button,Dropdown}from'semantic-ui-react';import*as firebase from'firebase/app';import'firebase/auth';import{LoginModal}from'../Modal/LoginModal';import axios from'axios';export var NewRoomButton=/*#__PURE__*/function(_React$Component){_inherits(NewRoomButton,_React$Component);var _super=_createSuper(NewRoomButton);function NewRoomButton(){var _this;_classCallCheck(this,NewRoomButton);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.createRoom=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,data,name;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return window.fetch(serverPath+'/createRoom',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({})});case 2:response=_context.sent;_context.next=5;return response.json();case 5:data=_context.sent;name=data.name;window.location.href='/#'+name;window.location.reload();case 9:case\"end\":return _context.stop();}}},_callee);}));return _this;}_createClass(NewRoomButton,[{key:\"render\",value:function render(){return/*#__PURE__*/_jsx(Popup,{content:\"Create a new room with a random URL that you can share with friends\",trigger:/*#__PURE__*/_jsxs(Button,{color:\"blue\",size:this.props.size,icon:true,labelPosition:\"left\",onClick:this.createRoom,className:\"toolButton\",children:[/*#__PURE__*/_jsx(Icon,{name:\"certificate\"}),\"New Room\"]})});}}]);return NewRoomButton;}(React.Component);export var SignInButton=/*#__PURE__*/function(_React$Component2){_inherits(SignInButton,_React$Component2);var _super2=_createSuper(SignInButton);function SignInButton(){var _this2;_classCallCheck(this,SignInButton);for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3];}_this2=_super2.call.apply(_super2,[this].concat(args));_this2.state={isLoginOpen:false};_this2.facebookSignIn=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var provider;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:provider=new firebase.auth.FacebookAuthProvider();_context2.next=3;return firebase.auth().signInWithPopup(provider);case 3:case\"end\":return _context2.stop();}}},_callee2);}));_this2.googleSignIn=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var provider;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:provider=new firebase.auth.GoogleAuthProvider();_context3.next=3;return firebase.auth().signInWithPopup(provider);case 3:case\"end\":return _context3.stop();}}},_callee3);}));_this2.signOut=function(){firebase.auth().signOut();window.location.reload();};return _this2;}_createClass(SignInButton,[{key:\"render\",value:function render(){var _this3=this;if(this.props.user){return/*#__PURE__*/_jsxs(Button,{style:{height:'36px'},icon:true,labelPosition:\"left\",onClick:this.signOut,fluid:this.props.fluid,children:[/*#__PURE__*/_jsx(Icon,{name:\"sign out\"}),\"Sign out\"]});}return/*#__PURE__*/_jsxs(React.Fragment,{children:[this.state.isLoginOpen&&/*#__PURE__*/_jsx(LoginModal,{closeLogin:function closeLogin(){return _this3.setState({isLoginOpen:false});}}),/*#__PURE__*/_jsx(Popup,{basic:true,content:\"Sign in to set your name and picture, subscribe, or launch VBrowsers\",trigger:/*#__PURE__*/_jsx(Dropdown,{style:{height:'36px'},icon:\"sign in\",labeled:true,className:\"icon\",button:true,text:\"Sign in\",fluid:this.props.fluid,children:/*#__PURE__*/_jsxs(Dropdown.Menu,{children:[/*#__PURE__*/_jsxs(Dropdown.Item,{onClick:this.facebookSignIn,children:[/*#__PURE__*/_jsx(Icon,{name:\"facebook\"}),\"Facebook\"]}),/*#__PURE__*/_jsxs(Dropdown.Item,{onClick:this.googleSignIn,children:[/*#__PURE__*/_jsx(Icon,{name:\"google\"}),\"Google\"]}),/*#__PURE__*/_jsxs(Dropdown.Item,{onClick:function onClick(){return _this3.setState({isLoginOpen:true});},children:[/*#__PURE__*/_jsx(Icon,{name:\"mail\"}),\"Email\"]})]})})})]});}}]);return SignInButton;}(React.Component);export var ListRoomsButton=/*#__PURE__*/function(_React$Component3){_inherits(ListRoomsButton,_React$Component3);var _super3=_createSuper(ListRoomsButton);function ListRoomsButton(){var _this4;_classCallCheck(this,ListRoomsButton);for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5];}_this4=_super3.call.apply(_super3,[this].concat(args));_this4.state={rooms:[]};_this4.refreshRooms=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var _this4$props$user,token,response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!_this4.props.user){_context4.next=8;break;}_context4.next=3;return _this4.props.user.getIdToken();case 3:token=_context4.sent;_context4.next=6;return axios.get(serverPath+\"/listRooms?uid=\".concat((_this4$props$user=_this4.props.user)===null||_this4$props$user===void 0?void 0:_this4$props$user.uid,\"&token=\").concat(token));case 6:response=_context4.sent;_this4.setState({rooms:response.data});case 8:case\"end\":return _context4.stop();}}},_callee4);}));_this4.deleteRoom=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(roomId){var _this4$props$user2,token;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!_this4.props.user){_context5.next=8;break;}_context5.next=3;return _this4.props.user.getIdToken();case 3:token=_context5.sent;_context5.next=6;return axios.delete(serverPath+\"/deleteRoom?uid=\".concat((_this4$props$user2=_this4.props.user)===null||_this4$props$user2===void 0?void 0:_this4$props$user2.uid,\"&token=\").concat(token,\"&roomId=\").concat(roomId));case 6:_this4.setState({rooms:_this4.state.rooms.filter(function(room){return room.roomId!==roomId;})});_this4.refreshRooms();case 8:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x){return _ref5.apply(this,arguments);};}();return _this4;}_createClass(ListRoomsButton,[{key:\"componentDidMount\",value:function componentDidMount(){this.refreshRooms();}},{key:\"render\",value:function render(){var _this5=this;return/*#__PURE__*/_jsx(Dropdown,{style:{height:'36px'},icon:\"group\",labeled:true,className:\"icon\",button:true,text:\"My Rooms\",onClick:this.refreshRooms,children:/*#__PURE__*/_jsxs(Dropdown.Menu,{children:[this.state.rooms.length===0&&/*#__PURE__*/_jsx(Dropdown.Item,{disabled:true,children:\"You have no permanent rooms.\"}),this.state.rooms.map(function(room){return/*#__PURE__*/_jsx(Dropdown.Item,{link:true,href:room.vanity?'/r/'+room.vanity:'/'+room.roomId.replace('/','#'),onClick:function onClick(){if(!room.vanity){setTimeout(function(){return window.location.reload();},100);}},children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex'},children:[room.vanity?\"/r/\".concat(room.vanity):room.roomId.replace('/','#'),/*#__PURE__*/_jsx(\"div\",{style:{marginLeft:'auto',paddingLeft:'20px'},children:/*#__PURE__*/_jsx(Popup,{content:\"Delete room\",trigger:/*#__PURE__*/_jsx(Icon,{onClick:function onClick(e){e.stopPropagation();_this5.deleteRoom(room.roomId);},name:\"x\",color:\"red\"})})})]})});})]})});}}]);return ListRoomsButton;}(React.Component);export var TopBar=/*#__PURE__*/function(_React$Component4){_inherits(TopBar,_React$Component4);var _super4=_createSuper(TopBar);function TopBar(){_classCallCheck(this,TopBar);return _super4.apply(this,arguments);}_createClass(TopBar,[{key:\"render\",value:function render(){return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexWrap:'wrap',padding:'1em',paddingBottom:'0px'},children:[/*#__PURE__*/_jsxs(\"a\",{href:\"/\",style:{display:'flex'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{height:'48px',width:'48px',marginRight:'10px',borderRadius:'50%',position:'relative',backgroundColor:'#'+colorMappings.blue},children:[/*#__PURE__*/_jsx(Icon,{inverted:true,name:\"film\",size:\"large\",style:{position:'absolute',top:8,width:'100%',margin:'0 auto'}}),/*#__PURE__*/_jsx(Icon,{inverted:true,name:\"group\",size:\"large\",color:\"green\",style:{position:'absolute',bottom:8,width:'100%',margin:'0 auto'}})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"div\",{style:{textTransform:'uppercase',fontWeight:700,color:'#2185d0',fontSize:'30px',lineHeight:'30px'},children:\"Watch\"}),/*#__PURE__*/_jsx(\"div\",{style:{textTransform:'uppercase',fontWeight:700,color:'#21ba45',fontSize:'30px',lineHeight:'30px',marginLeft:'auto'},children:\"Party\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',marginLeft:'10px',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"a\",{href:\"https://discord.gg/3rYj5HV\",target:\"_blank\",rel:\"noopener noreferrer\",className:\"footerIcon\",title:\"Discord\",children:/*#__PURE__*/_jsx(Icon,{name:\"discord\",size:\"big\",link:true})}),/*#__PURE__*/_jsx(\"a\",{href:\"https://github.com/howardchung/watchparty\",target:\"_blank\",rel:\"noopener noreferrer\",className:\"footerIcon\",title:\"GitHub\",children:/*#__PURE__*/_jsx(Icon,{name:\"github\",size:\"big\",link:true})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',marginLeft:'auto'},children:[!this.props.hideNewRoom&&/*#__PURE__*/_jsx(NewRoomButton,{}),!this.props.hideMyRooms&&this.props.user&&/*#__PURE__*/_jsx(ListRoomsButton,{user:this.props.user}),!this.props.hideSignin&&/*#__PURE__*/_jsx(SignInButton,{user:this.props.user})]})]})});}}]);return TopBar;}(React.Component);","map":{"version":3,"sources":["/home/runner/work/watchparty/watchparty/src/components/TopBar/TopBar.tsx"],"names":["React","serverPath","colorMappings","Icon","Popup","Button","Dropdown","firebase","LoginModal","axios","NewRoomButton","createRoom","window","fetch","method","headers","body","JSON","stringify","response","json","data","name","location","href","reload","props","size","Component","SignInButton","state","isLoginOpen","facebookSignIn","provider","auth","FacebookAuthProvider","signInWithPopup","googleSignIn","GoogleAuthProvider","signOut","user","height","fluid","setState","ListRoomsButton","rooms","refreshRooms","getIdToken","token","get","uid","deleteRoom","roomId","delete","filter","room","length","map","vanity","replace","setTimeout","display","marginLeft","paddingLeft","e","stopPropagation","TopBar","flexWrap","padding","paddingBottom","width","marginRight","borderRadius","position","backgroundColor","blue","top","margin","bottom","alignItems","textTransform","fontWeight","color","fontSize","lineHeight","hideNewRoom","hideMyRooms","hideSignin"],"mappings":"y/BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,UAAT,CAAqBC,aAArB,KAA0C,aAA1C,CACA,OAASC,IAAT,CAAeC,KAAf,CAAsBC,MAAtB,CAA8BC,QAA9B,KAA8C,mBAA9C,CACA,MAAO,GAAKC,CAAAA,QAAZ,KAA0B,cAA1B,CACA,MAAO,eAAP,CACA,OAASC,UAAT,KAA2B,qBAA3B,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAEA,UAAaC,CAAAA,aAAb,mWACEC,UADF,sEACe,gLACYC,CAAAA,MAAM,CAACC,KAAP,CAAaZ,UAAU,CAAG,aAA1B,CAAyC,CAC9Da,MAAM,CAAE,MADsD,CAE9DC,OAAO,CAAE,CACP,eAAgB,kBADT,CAFqD,CAK9DC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,EAAf,CALwD,CAAzC,CADZ,QACLC,QADK,qCAQQA,CAAAA,QAAQ,CAACC,IAAT,EARR,QAQLC,IARK,eASHC,IATG,CASMD,IATN,CASHC,IATG,CAUXV,MAAM,CAACW,QAAP,CAAgBC,IAAhB,CAAuB,KAAOF,IAA9B,CACAV,MAAM,CAACW,QAAP,CAAgBE,MAAhB,GAXW,sDADf,kFAcW,CACP,mBACE,KAAC,KAAD,EACE,OAAO,CAAC,qEADV,CAEE,OAAO,cACL,MAAC,MAAD,EACE,KAAK,CAAC,MADR,CAEE,IAAI,CAAE,KAAKC,KAAL,CAAWC,IAFnB,CAGE,IAAI,KAHN,CAIE,aAAa,CAAC,MAJhB,CAKE,OAAO,CAAE,KAAKhB,UALhB,CAME,SAAS,CAAC,YANZ,wBAQE,KAAC,IAAD,EAAM,IAAI,CAAC,aAAX,EARF,cAHJ,EADF,CAkBD,CAjCH,2BAAmCX,KAAK,CAAC4B,SAAzC,EAoCA,UAAaC,CAAAA,YAAb,+WAISC,KAJT,CAIiB,CAAEC,WAAW,CAAE,KAAf,CAJjB,QAMEC,cANF,sEAMmB,qJACTC,QADS,CACE,GAAI1B,CAAAA,QAAQ,CAAC2B,IAAT,CAAcC,oBAAlB,EADF,wBAET5B,CAAAA,QAAQ,CAAC2B,IAAT,GAAgBE,eAAhB,CAAgCH,QAAhC,CAFS,yDANnB,UAWEI,YAXF,sEAWiB,qJACPJ,QADO,CACI,GAAI1B,CAAAA,QAAQ,CAAC2B,IAAT,CAAcI,kBAAlB,EADJ,wBAEP/B,CAAAA,QAAQ,CAAC2B,IAAT,GAAgBE,eAAhB,CAAgCH,QAAhC,CAFO,yDAXjB,UAgBEM,OAhBF,CAgBY,UAAM,CACdhC,QAAQ,CAAC2B,IAAT,GAAgBK,OAAhB,GACA3B,MAAM,CAACW,QAAP,CAAgBE,MAAhB,GACD,CAnBH,gFAqBW,iBACP,GAAI,KAAKC,KAAL,CAAWc,IAAf,CAAqB,CACnB,mBACE,MAAC,MAAD,EACE,KAAK,CAAE,CAAEC,MAAM,CAAE,MAAV,CADT,CAEE,IAAI,KAFN,CAGE,aAAa,CAAC,MAHhB,CAIE,OAAO,CAAE,KAAKF,OAJhB,CAKE,KAAK,CAAE,KAAKb,KAAL,CAAWgB,KALpB,wBAOE,KAAC,IAAD,EAAM,IAAI,CAAC,UAAX,EAPF,cADF,CAYD,CACD,mBACE,MAAC,KAAD,CAAO,QAAP,YACG,KAAKZ,KAAL,CAAWC,WAAX,eACC,KAAC,UAAD,EACE,UAAU,CAAE,4BAAM,CAAA,MAAI,CAACY,QAAL,CAAc,CAAEZ,WAAW,CAAE,KAAf,CAAd,CAAN,EADd,EAFJ,cAME,KAAC,KAAD,EACE,KAAK,KADP,CAEE,OAAO,CAAC,sEAFV,CAGE,OAAO,cACL,KAAC,QAAD,EACE,KAAK,CAAE,CAAEU,MAAM,CAAE,MAAV,CADT,CAEE,IAAI,CAAC,SAFP,CAGE,OAAO,KAHT,CAIE,SAAS,CAAC,MAJZ,CAKE,MAAM,KALR,CAME,IAAI,CAAC,SANP,CAOE,KAAK,CAAE,KAAKf,KAAL,CAAWgB,KAPpB,uBASE,MAAC,QAAD,CAAU,IAAV,yBACE,MAAC,QAAD,CAAU,IAAV,EAAe,OAAO,CAAE,KAAKV,cAA7B,wBACE,KAAC,IAAD,EAAM,IAAI,CAAC,UAAX,EADF,cADF,cAKE,MAAC,QAAD,CAAU,IAAV,EAAe,OAAO,CAAE,KAAKK,YAA7B,wBACE,KAAC,IAAD,EAAM,IAAI,CAAC,QAAX,EADF,YALF,cASE,MAAC,QAAD,CAAU,IAAV,EACE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACM,QAAL,CAAc,CAAEZ,WAAW,CAAE,IAAf,CAAd,CAAN,EADX,wBAGE,KAAC,IAAD,EAAM,IAAI,CAAC,MAAX,EAHF,WATF,GATF,EAJJ,EANF,GADF,CAyCD,CA7EH,0BAAkC/B,KAAK,CAAC4B,SAAxC,EAgFA,UAAagB,CAAAA,eAAb,2XAGSd,KAHT,CAGiB,CAAEe,KAAK,CAAE,EAAT,CAHjB,QASEC,YATF,sEASiB,iLACT,OAAKpB,KAAL,CAAWc,IADF,iDAES,QAAKd,KAAL,CAAWc,IAAX,CAAgBO,UAAhB,EAFT,QAELC,KAFK,uCAGYvC,CAAAA,KAAK,CAACwC,GAAN,CACrBhD,UAAU,6CAAqB,OAAKyB,KAAL,CAAWc,IAAhC,4CAAqB,kBAAiBU,GAAtC,mBAAmDF,KAAnD,CADW,CAHZ,QAGL7B,QAHK,gBAMX,OAAKwB,QAAL,CAAc,CAAEE,KAAK,CAAE1B,QAAQ,CAACE,IAAlB,CAAd,EANW,wDATjB,UAmBE8B,UAnBF,2FAmBe,kBAAOC,MAAP,uJACP,OAAK1B,KAAL,CAAWc,IADJ,iDAEW,QAAKd,KAAL,CAAWc,IAAX,CAAgBO,UAAhB,EAFX,QAEHC,KAFG,uCAGHvC,CAAAA,KAAK,CAAC4C,MAAN,CACJpD,UAAU,+CACW,OAAKyB,KAAL,CAAWc,IADtB,6CACW,mBAAiBU,GAD5B,mBACyCF,KADzC,oBACyDI,MADzD,CADN,CAHG,QAOT,OAAKT,QAAL,CAAc,CACZE,KAAK,CAAE,OAAKf,KAAL,CAAWe,KAAX,CAAiBS,MAAjB,CAAwB,SAACC,IAAD,QAAUA,CAAAA,IAAI,CAACH,MAAL,GAAgBA,MAA1B,EAAxB,CADK,CAAd,EAGA,OAAKN,YAAL,GAVS,wDAnBf,wKAKsB,CAClB,KAAKA,YAAL,GACD,CAPH,uCAiCW,iBACP,mBACE,KAAC,QAAD,EACE,KAAK,CAAE,CAAEL,MAAM,CAAE,MAAV,CADT,CAEE,IAAI,CAAC,OAFP,CAGE,OAAO,KAHT,CAIE,SAAS,CAAC,MAJZ,CAKE,MAAM,KALR,CAME,IAAI,CAAC,UANP,CAOE,OAAO,CAAE,KAAKK,YAPhB,uBASE,MAAC,QAAD,CAAU,IAAV,YACG,KAAKhB,KAAL,CAAWe,KAAX,CAAiBW,MAAjB,GAA4B,CAA5B,eACC,KAAC,QAAD,CAAU,IAAV,EAAe,QAAQ,KAAvB,0CAFJ,CAIG,KAAK1B,KAAL,CAAWe,KAAX,CAAiBY,GAAjB,CAAqB,SAACF,IAAD,CAAe,CACnC,mBACE,KAAC,QAAD,CAAU,IAAV,EACE,IAAI,KADN,CAEE,IAAI,CACFA,IAAI,CAACG,MAAL,CACI,MAAQH,IAAI,CAACG,MADjB,CAEI,IAAMH,IAAI,CAACH,MAAL,CAAYO,OAAZ,CAAoB,GAApB,CAAyB,GAAzB,CALd,CAOE,OAAO,CAAE,kBAAM,CACb,GAAI,CAACJ,IAAI,CAACG,MAAV,CAAkB,CAChBE,UAAU,CAAC,iBAAMhD,CAAAA,MAAM,CAACW,QAAP,CAAgBE,MAAhB,EAAN,EAAD,CAAiC,GAAjC,CAAV,CACD,CACF,CAXH,uBAaE,aAAK,KAAK,CAAE,CAAEoC,OAAO,CAAE,MAAX,CAAZ,WACGN,IAAI,CAACG,MAAL,cACSH,IAAI,CAACG,MADd,EAEGH,IAAI,CAACH,MAAL,CAAYO,OAAZ,CAAoB,GAApB,CAAyB,GAAzB,CAHN,cAIE,YAAK,KAAK,CAAE,CAAEG,UAAU,CAAE,MAAd,CAAsBC,WAAW,CAAE,MAAnC,CAAZ,uBACE,KAAC,KAAD,EACE,OAAO,CAAC,aADV,CAEE,OAAO,cACL,KAAC,IAAD,EACE,OAAO,CAAE,iBAACC,CAAD,CAAyB,CAChCA,CAAC,CAACC,eAAF,GACA,MAAI,CAACd,UAAL,CAAgBI,IAAI,CAACH,MAArB,EACD,CAJH,CAKE,IAAI,CAAC,GALP,CAME,KAAK,CAAC,KANR,EAHJ,EADF,EAJF,GAbF,EADF,CAoCD,CArCA,CAJH,GATF,EADF,CAuDD,CAzFH,6BAAqCpD,KAAK,CAAC4B,SAA3C,EA4FA,UAAasC,CAAAA,MAAb,8PAMW,CACP,mBACE,KAAC,KAAD,CAAO,QAAP,wBACE,aACE,KAAK,CAAE,CACLL,OAAO,CAAE,MADJ,CAELM,QAAQ,CAAE,MAFL,CAGLC,OAAO,CAAE,KAHJ,CAILC,aAAa,CAAE,KAJV,CADT,wBAQE,WAAG,IAAI,CAAC,GAAR,CAAY,KAAK,CAAE,CAAER,OAAO,CAAE,MAAX,CAAnB,wBACE,aACE,KAAK,CAAE,CACLpB,MAAM,CAAE,MADH,CAEL6B,KAAK,CAAE,MAFF,CAGLC,WAAW,CAAE,MAHR,CAILC,YAAY,CAAE,KAJT,CAKLC,QAAQ,CAAE,UALL,CAMLC,eAAe,CAAE,IAAMxE,aAAa,CAACyE,IANhC,CADT,wBAUE,KAAC,IAAD,EACE,QAAQ,KADV,CAEE,IAAI,CAAC,MAFP,CAGE,IAAI,CAAC,OAHP,CAIE,KAAK,CAAE,CACLF,QAAQ,CAAE,UADL,CAELG,GAAG,CAAE,CAFA,CAGLN,KAAK,CAAE,MAHF,CAILO,MAAM,CAAE,QAJH,CAJT,EAVF,cAqBE,KAAC,IAAD,EACE,QAAQ,KADV,CAEE,IAAI,CAAC,OAFP,CAGE,IAAI,CAAC,OAHP,CAIE,KAAK,CAAC,OAJR,CAKE,KAAK,CAAE,CACLJ,QAAQ,CAAE,UADL,CAELK,MAAM,CAAE,CAFH,CAGLR,KAAK,CAAE,MAHF,CAILO,MAAM,CAAE,QAJH,CALT,EArBF,GADF,cAmCE,aACE,KAAK,CAAE,CACLhB,OAAO,CAAE,MADJ,CAELkB,UAAU,CAAE,QAFP,CADT,wBAME,YACE,KAAK,CAAE,CACLC,aAAa,CAAE,WADV,CAELC,UAAU,CAAE,GAFP,CAGLC,KAAK,CAAE,SAHF,CAILC,QAAQ,CAAE,MAJL,CAKLC,UAAU,CAAE,MALP,CADT,mBANF,cAiBE,YACE,KAAK,CAAE,CACLJ,aAAa,CAAE,WADV,CAELC,UAAU,CAAE,GAFP,CAGLC,KAAK,CAAE,SAHF,CAILC,QAAQ,CAAE,MAJL,CAKLC,UAAU,CAAE,MALP,CAMLtB,UAAU,CAAE,MANP,CADT,mBAjBF,GAnCF,GARF,cA0EE,aACE,KAAK,CAAE,CACLD,OAAO,CAAE,MADJ,CAELC,UAAU,CAAE,MAFP,CAGLiB,UAAU,CAAE,QAHP,CADT,wBAOE,UACE,IAAI,CAAC,4BADP,CAEE,MAAM,CAAC,QAFT,CAGE,GAAG,CAAC,qBAHN,CAIE,SAAS,CAAC,YAJZ,CAKE,KAAK,CAAC,SALR,uBAOE,KAAC,IAAD,EAAM,IAAI,CAAC,SAAX,CAAqB,IAAI,CAAC,KAA1B,CAAgC,IAAI,KAApC,EAPF,EAPF,cAgBE,UACE,IAAI,CAAC,2CADP,CAEE,MAAM,CAAC,QAFT,CAGE,GAAG,CAAC,qBAHN,CAIE,SAAS,CAAC,YAJZ,CAKE,KAAK,CAAC,QALR,uBAOE,KAAC,IAAD,EAAM,IAAI,CAAC,QAAX,CAAoB,IAAI,CAAC,KAAzB,CAA+B,IAAI,KAAnC,EAPF,EAhBF,GA1EF,cAoGE,aACE,KAAK,CAAE,CACLlB,OAAO,CAAE,MADJ,CAELC,UAAU,CAAE,MAFP,CADT,WAMG,CAAC,KAAKpC,KAAL,CAAW2D,WAAZ,eAA2B,KAAC,aAAD,IAN9B,CAOG,CAAC,KAAK3D,KAAL,CAAW4D,WAAZ,EAA2B,KAAK5D,KAAL,CAAWc,IAAtC,eACC,KAAC,eAAD,EAAiB,IAAI,CAAE,KAAKd,KAAL,CAAWc,IAAlC,EARJ,CAUG,CAAC,KAAKd,KAAL,CAAW6D,UAAZ,eAA0B,KAAC,YAAD,EAAc,IAAI,CAAE,KAAK7D,KAAL,CAAWc,IAA/B,EAV7B,GApGF,GADF,EADF,CAqHD,CA5HH,oBAA4BxC,KAAK,CAAC4B,SAAlC","sourcesContent":["import React from 'react';\nimport { serverPath, colorMappings } from '../../utils';\nimport { Icon, Popup, Button, Dropdown } from 'semantic-ui-react';\nimport * as firebase from 'firebase/app';\nimport 'firebase/auth';\nimport { LoginModal } from '../Modal/LoginModal';\nimport axios from 'axios';\n\nexport class NewRoomButton extends React.Component<{ size?: string }> {\n  createRoom = async () => {\n    const response = await window.fetch(serverPath + '/createRoom', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({}),\n    });\n    const data = await response.json();\n    const { name } = data;\n    window.location.href = '/#' + name;\n    window.location.reload();\n  };\n  render() {\n    return (\n      <Popup\n        content=\"Create a new room with a random URL that you can share with friends\"\n        trigger={\n          <Button\n            color=\"blue\"\n            size={this.props.size as any}\n            icon\n            labelPosition=\"left\"\n            onClick={this.createRoom}\n            className=\"toolButton\"\n          >\n            <Icon name=\"certificate\" />\n            New Room\n          </Button>\n        }\n      />\n    );\n  }\n}\n\nexport class SignInButton extends React.Component<{\n  user: firebase.User | undefined;\n  fluid?: boolean;\n}> {\n  public state = { isLoginOpen: false };\n\n  facebookSignIn = async () => {\n    const provider = new firebase.auth.FacebookAuthProvider();\n    await firebase.auth().signInWithPopup(provider);\n  };\n\n  googleSignIn = async () => {\n    const provider = new firebase.auth.GoogleAuthProvider();\n    await firebase.auth().signInWithPopup(provider);\n  };\n\n  signOut = () => {\n    firebase.auth().signOut();\n    window.location.reload();\n  };\n\n  render() {\n    if (this.props.user) {\n      return (\n        <Button\n          style={{ height: '36px' }}\n          icon\n          labelPosition=\"left\"\n          onClick={this.signOut}\n          fluid={this.props.fluid}\n        >\n          <Icon name=\"sign out\" />\n          Sign out\n        </Button>\n      );\n    }\n    return (\n      <React.Fragment>\n        {this.state.isLoginOpen && (\n          <LoginModal\n            closeLogin={() => this.setState({ isLoginOpen: false })}\n          />\n        )}\n        <Popup\n          basic\n          content=\"Sign in to set your name and picture, subscribe, or launch VBrowsers\"\n          trigger={\n            <Dropdown\n              style={{ height: '36px' }}\n              icon=\"sign in\"\n              labeled\n              className=\"icon\"\n              button\n              text=\"Sign in\"\n              fluid={this.props.fluid}\n            >\n              <Dropdown.Menu>\n                <Dropdown.Item onClick={this.facebookSignIn}>\n                  <Icon name=\"facebook\" />\n                  Facebook\n                </Dropdown.Item>\n                <Dropdown.Item onClick={this.googleSignIn}>\n                  <Icon name=\"google\" />\n                  Google\n                </Dropdown.Item>\n                <Dropdown.Item\n                  onClick={() => this.setState({ isLoginOpen: true })}\n                >\n                  <Icon name=\"mail\" />\n                  Email\n                </Dropdown.Item>\n              </Dropdown.Menu>\n            </Dropdown>\n          }\n        />\n      </React.Fragment>\n    );\n  }\n}\n\nexport class ListRoomsButton extends React.Component<{\n  user: firebase.User | undefined;\n}> {\n  public state = { rooms: [] as PermanentRoom[] };\n\n  componentDidMount() {\n    this.refreshRooms();\n  }\n\n  refreshRooms = async () => {\n    if (this.props.user) {\n      const token = await this.props.user.getIdToken();\n      const response = await axios.get(\n        serverPath + `/listRooms?uid=${this.props.user?.uid}&token=${token}`\n      );\n      this.setState({ rooms: response.data });\n    }\n  };\n\n  deleteRoom = async (roomId: string) => {\n    if (this.props.user) {\n      const token = await this.props.user.getIdToken();\n      await axios.delete(\n        serverPath +\n          `/deleteRoom?uid=${this.props.user?.uid}&token=${token}&roomId=${roomId}`\n      );\n      this.setState({\n        rooms: this.state.rooms.filter((room) => room.roomId !== roomId),\n      });\n      this.refreshRooms();\n    }\n  };\n\n  render() {\n    return (\n      <Dropdown\n        style={{ height: '36px' }}\n        icon=\"group\"\n        labeled\n        className=\"icon\"\n        button\n        text=\"My Rooms\"\n        onClick={this.refreshRooms}\n      >\n        <Dropdown.Menu>\n          {this.state.rooms.length === 0 && (\n            <Dropdown.Item disabled>You have no permanent rooms.</Dropdown.Item>\n          )}\n          {this.state.rooms.map((room: any) => {\n            return (\n              <Dropdown.Item\n                link\n                href={\n                  room.vanity\n                    ? '/r/' + room.vanity\n                    : '/' + room.roomId.replace('/', '#')\n                }\n                onClick={() => {\n                  if (!room.vanity) {\n                    setTimeout(() => window.location.reload(), 100);\n                  }\n                }}\n              >\n                <div style={{ display: 'flex' }}>\n                  {room.vanity\n                    ? `/r/${room.vanity}`\n                    : room.roomId.replace('/', '#')}\n                  <div style={{ marginLeft: 'auto', paddingLeft: '20px' }}>\n                    <Popup\n                      content=\"Delete room\"\n                      trigger={\n                        <Icon\n                          onClick={(e: React.MouseEvent) => {\n                            e.stopPropagation();\n                            this.deleteRoom(room.roomId);\n                          }}\n                          name=\"x\"\n                          color=\"red\"\n                        />\n                      }\n                    />\n                  </div>\n                </div>\n              </Dropdown.Item>\n            );\n          })}\n        </Dropdown.Menu>\n      </Dropdown>\n    );\n  }\n}\n\nexport class TopBar extends React.Component<{\n  user?: any;\n  hideNewRoom?: boolean;\n  hideSignin?: boolean;\n  hideMyRooms?: boolean;\n}> {\n  render() {\n    return (\n      <React.Fragment>\n        <div\n          style={{\n            display: 'flex',\n            flexWrap: 'wrap',\n            padding: '1em',\n            paddingBottom: '0px',\n          }}\n        >\n          <a href=\"/\" style={{ display: 'flex' }}>\n            <div\n              style={{\n                height: '48px',\n                width: '48px',\n                marginRight: '10px',\n                borderRadius: '50%',\n                position: 'relative',\n                backgroundColor: '#' + colorMappings.blue,\n              }}\n            >\n              <Icon\n                inverted\n                name=\"film\"\n                size=\"large\"\n                style={{\n                  position: 'absolute',\n                  top: 8,\n                  width: '100%',\n                  margin: '0 auto',\n                }}\n              />\n              <Icon\n                inverted\n                name=\"group\"\n                size=\"large\"\n                color=\"green\"\n                style={{\n                  position: 'absolute',\n                  bottom: 8,\n                  width: '100%',\n                  margin: '0 auto',\n                }}\n              />\n            </div>\n            <div\n              style={{\n                display: 'flex',\n                alignItems: 'center',\n              }}\n            >\n              <div\n                style={{\n                  textTransform: 'uppercase',\n                  fontWeight: 700,\n                  color: '#2185d0',\n                  fontSize: '30px',\n                  lineHeight: '30px',\n                }}\n              >\n                Watch\n              </div>\n              <div\n                style={{\n                  textTransform: 'uppercase',\n                  fontWeight: 700,\n                  color: '#21ba45',\n                  fontSize: '30px',\n                  lineHeight: '30px',\n                  marginLeft: 'auto',\n                }}\n              >\n                Party\n              </div>\n            </div>\n          </a>\n          <div\n            style={{\n              display: 'flex',\n              marginLeft: '10px',\n              alignItems: 'center',\n            }}\n          >\n            <a\n              href=\"https://discord.gg/3rYj5HV\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"footerIcon\"\n              title=\"Discord\"\n            >\n              <Icon name=\"discord\" size=\"big\" link />\n            </a>\n            <a\n              href=\"https://github.com/howardchung/watchparty\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"footerIcon\"\n              title=\"GitHub\"\n            >\n              <Icon name=\"github\" size=\"big\" link />\n            </a>\n          </div>\n          <div\n            style={{\n              display: 'flex',\n              marginLeft: 'auto',\n            }}\n          >\n            {!this.props.hideNewRoom && <NewRoomButton />}\n            {!this.props.hideMyRooms && this.props.user && (\n              <ListRoomsButton user={this.props.user} />\n            )}\n            {!this.props.hideSignin && <SignInButton user={this.props.user} />}\n          </div>\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}